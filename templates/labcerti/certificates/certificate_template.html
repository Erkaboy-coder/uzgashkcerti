{% load static %}
<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>Guvohnoma № {{ cert.certificate_number }}</title>
    <style>
        @page { size: A4; margin: 0; }
        body { margin: 0; padding: 0; font-family: Arial, sans-serif; font-size: 13px; color: #000; }
        .certificate-container {
            width: 210mm;
            height: 297mm;
            margin: 0 auto;
            padding: 20px; /* Padding kamaytirildi */
            box-sizing: border-box;
            border: 10px double cornflowerblue;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* Header */
        .header-row {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 10px;
            border-bottom: 4px double darkblue;
            padding-bottom: 5px;
            align-items: center; /* Vertikal joylashuv uchun */
            justify-content: space-between;
        }
        .logo-col {
            flex: 0 0 20%; /* Kichikroq joy ajratildi */
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .text-col-full {
            flex: 0 0 55%; /* Ko'proq joy ajratildi */
            text-align: center;
        }
        .text-col-full h5 { margin: 0; font-size: 14px; font-weight: bold; } /* Font hajmi kichraytirildi */

        /* Title */
        .title-section {
            text-align: center;
            margin: 10px 0; /* Margin kamaytirildi */
            border-bottom: 4px double darkblue;
            padding-bottom: 5px;
        }
        .title-section h1 { font-size: 20px; color: darkblue; margin-bottom: 2px; letter-spacing: 2px; font-weight: bolder; }
        .title-section h2 { font-size: 14px; font-weight: bold; margin-bottom: 5px; letter-spacing: 1px; }
        .title-section p { margin: 0; font-size: 24px; color: darkred; font-weight: bold; }

        /* Details Grid */
        .details-grid {
            margin-top: 10px;
            padding: 5px;
            font-size: 12px; /* Font hajmi kamaytirildi */
        }
        .details-row {
            display: flex;
            margin-bottom: 5px; /* Margin kamaytirildi */
            line-height: 1.2;
        }
        .label {
            width: 45%; /* Hajm qayta sozlandi */
            text-align: right;
            font-weight: bold;
            padding-right: 10px;
            box-sizing: border-box;
        }
        .colon {
            width: 10px;
            text-align: center;
        }
        .value {
            width: 50%;
            word-break: break-word;
            overflow-wrap: break-word;
        }

        /* Footer */
        .footer-info {
            margin-top: 15px; /* Margin kamaytirildi */
            border-top: 4px double darkblue;
            padding-top: 8px;
            font-size: 12px;
            text-align: justify;
        }
        .signatures {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-top: 30px; /* Margin kamaytirildi */
        }
        .sign-box { text-align: center; font-size: 12px; } /* Font hajmi kamaytirildi */
        .sign-box p { margin: 0; }
        .qr-code { width: 80px; height: 80px; margin-bottom: 5px; }
        .bottom-warning { margin-top: 10px; font-size: 11px; text-align: center; color: red; font-weight: bold; }
        a { text-decoration: none; color: #007bff; }
    </style>
</head>
<body>
    <div class="certificate-container">

        <div class="header-row" style="flex-direction: column; border-bottom:4px double darkblue; padding-bottom:5px;">

            <!-- First Row -->
            <div style="display:flex; justify-content: space-between; align-items:center; margin-bottom:5px;">
                <div class="logo-col">
                    <img src="{% static 'assets/logo/image.png' %}" alt="Logo" style="height:80px; width:80px; object-fit:contain;">
                </div>
                <div class="text-col-full">
                    <h5>“O‘zGASHKLITI” MCHJ Qurilishda muhandislik qidiruvlari,</h5>
                    <h5>geoaxborot va shaharsozlik kadastri loyiha ilmiy-tadqiqot instituti</h5>
                </div>
            </div>

            <!-- Second Row -->
            <div style="display:flex; justify-content: space-between; align-items:center;">
                <div class="logo-col">
                    <img src="{% static 'assets/logo/logo2.png' %}" alt="Logo" style="height:80px; width:80px; object-fit:contain;">
                </div>
                <div class="text-col-full">
                    <h5>O‘ZBEKISTON RESPUBLIKASIDA O‘LCHASHLARNING YAGONA</h5>
                    <h5>BIRLIKDA BO'LISHINI TA’MINLASH TIZIMI</h5>
                </div>
            </div>

        </div>


        <!-- Certificate Title -->
        <div class="title-section">
            <h2>O‘lchash vositasini qiyoslash</h2>
            <h1>GUVOHNOMASI</h1>
            <p>№ {{ cert.certificate_number }}</p>
        </div>

        <!-- Certificate Details -->
        <div class="details-grid">
            {% if cert.standards_used %}
            <div class="details-row">
                <div class="label">Etalonlar (namunaviy o‘lchash vositalari) nomi va belgilanishi</div><div class="colon">:</div><div class="value">{{ cert.standards_used }}</div>
            </div>
            {% endif %}
            {% if cert.comparison_document %}
            <div class="details-row">
                <div class="label">Qiyoslash bo‘yicha hujjat nomi va belgilanishi</div><div class="colon">:</div><div class="value">{{ cert.comparison_document }}</div>
            </div>
            {% endif %}
            {% if cert.owner_name %}
            <div class="details-row">
                <div class="label">O‘lchash vositalarining egasi - yuridik shaxs</div><div class="colon">:</div><div class="value">INN: {{ cert.owner_inn }}<br> Nomi: {{ cert.owner_name }}</div>
            </div>
            {% endif %}
            {% if cert.manufacturer %}
            <div class="details-row">
                <div class="label">O‘lchash vositalarini tayyorlovchi</div><div class="colon">:</div><div class="value">{{ cert.manufacturer }}</div>
            </div>
            {% endif %}
            {% if cert.origin_country %}
            <div class="details-row">
                <div class="label">Tayyorlovchi – import qiluvchi mamlakat</div><div class="colon">:</div><div class="value">{{ cert.origin_country }}</div>
            </div>
            {% endif %}
            {% if cert.measurement_range %}
            <div class="details-row">
                <div class="label">O‘lchash vositalari parametrlari</div><div class="colon">:</div><div class="value">{{ cert.measurement_range }}</div>
            </div>
            {% endif %}
            {% if cert.error_limit %}
            <div class="details-row">
                <div class="label">Xatolik chegaralari / aniqlik klassi</div><div class="colon">:</div><div class="value">{{ cert.error_limit }}</div>
            </div>
            {% endif %}
            {% if cert.device_name %}
            <div class="details-row">
                <div class="label">O‘lchash vositasi</div><div class="colon">:</div><div class="value">{{ cert.device_name }}</div>
            </div>
            {% endif %}
            {% if cert.device_serial_numbers %}
            <div class="details-row">
                <div class="label">Zavod raqami</div><div class="colon">:</div><div class="value">{{ cert.device_serial_numbers }}</div>
            </div>
            {% endif %}
            {% if cert.comparison_methodology_doc %}
            <div class="details-row">
                <div class="label">Normativ hujjat</div><div class="colon">:</div><div class="value">{{ cert.comparison_methodology_doc }}</div>
            </div>
            {% endif %}
        </div>

        <!-- Certification Info -->
        <div class="footer-info">
            <p>Mazkur guvohnoma o‘lchash vositalari bo‘yicha etalonlarga muvofiqlikni tasdiqlaydi va o‘lchash birliklarini belgilangan standartlarga mos holda taqdim etadi.</p>
        </div>

        <!-- Signatures -->
        <div class="signatures">
            <div class="sign-box">
                {% if cert.qr_code_image %}
                    <img src="{{ cert.qr_code_image.url }}" alt="QR code" class="qr-code">
                {% else %}
                    <div class="qr-code" style="border:1px dashed gray; display:flex; align-items:center; justify-content:center; font-size:10px;">QR CODE JOY</div>
                {% endif %}
                <p>Qiyoslash sanasi: <strong>{{ cert.comparison_date|date:"Y -yil d -F" }}</strong></p>
                <p>Amal qilish muddati: <strong>{{ cert.valid_until|date:"Y -yil d -F" }}gacha</strong></p>
            </div>


            <div class="sign-box">
                <p>Qiyoslovchi</p>
                <p style="font-weight:bold;">{{ cert.metrologist_name }}</p>
                <p style="border-top:1px solid black; width:100px; margin:5px auto 0;"></p>
            </div>

            <div class="sign-box">
                <p>Tasdiqlovchi</p>
                <p style="font-weight:bold;">
                    {% if cert.approved_by %}{{ cert.approved_by.user.get_full_name }}{% else %}_______________{% endif %}
                </p>
                <p style="border-top:1px solid black; width:100px; margin:5px auto 0;"></p>
            </div>
        </div>

        <!-- Bottom Warning -->
        <div class="bottom-warning">
            Mazkur guvohnomani qalbakilashtirish - qonunga muvofiq javobgarlikka tortiladi.
        </div>

    </div>
</body>
</html>
