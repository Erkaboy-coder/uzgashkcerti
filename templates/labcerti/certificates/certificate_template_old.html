{% load static %}
<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>Guvohnoma № {{ cert.certificate_number }}</title>
    <style>
        @page { size: A4; margin: 0; }
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            font-size: 13px;
            color: #000;
        }
        .certificate-container {
            width: 210mm;
            height: 297mm;
            margin: 0 auto;
            padding: 10mm 20mm 60mm 20mm; /* Footer uchun joy qoldirildi */
            box-sizing: border-box;
            border: 10px double cornflowerblue;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Header */
        .header-row {
            display: flex;
            flex-wrap: wrap;
            border-bottom: 4px double darkblue;
            padding-bottom: 5px;
            margin-bottom: 10px;
            justify-content: space-between;
            align-items: center;
        }
        .logo-col {
            flex: 0 0 20%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .text-col-full {
            flex: 0 0 75%;
            text-align: center;
        }
        .text-col-full h5 {
            margin: 0;
            font-size: 15px;
            font-weight: bold;
            line-height: 1.4;
        }

        /* Title */
        .title-section {
            text-align: center;
            border-bottom: 4px double darkblue;
            padding-bottom: 5px;
            margin-bottom: 10px;
        }
        .title-section h1 {
            font-size: 22px;
            color: darkblue;
            margin-bottom: 2px;
            letter-spacing: 2px;
            font-weight: bolder;
        }
        .title-section h2 {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }
        .title-section p {
            margin: 0;
            font-size: 22px;
            color: darkred;
            font-weight: bold;
        }

        /* Details */
        .details-grid {
            flex: 1;
            font-size: 13px;
            line-height: 1.5;
            margin-top: 5px;
        }
        .details-row {
            display: flex;
            margin-bottom: 8px;
        }
        .label {
            width: 35%;
            text-align: right;
            font-weight: bold;
            padding-right: 10px;
            vertical-align: top;
        }
        .colon {
            width: 10px;
            text-align: center;
        }
        .value {
            width: 55%;
            word-break: break-word;
            overflow-wrap: break-word;
            padding-left: 5px;
        }

        /* Footer Fixed */
        .footer-container {
            position: absolute;
            bottom: 10mm;
            left: 20mm;
            right: 20mm;
        }
        .footer-info {
            border-top: 4px double darkblue;
            padding-top: 5px;
            font-size: 12px;
            text-align: justify;
        }

        /* Signatures */
        .signatures {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-top: 5px;
        }
        .sign-box {
            text-align: center;
            font-size: 12px;
        }
        .sign-box p {
            margin: 2px 0;
        }
        .qr-code {
            width: 90px;
            height: 90px;
            margin-bottom: 3px;
        }

        /* Bottom Warning */
        .bottom-warning {
            margin-top: 5px;
            font-size: 11px;
            text-align: center;
            color: red;
            font-weight: bold;
        }

        a { text-decoration: none; color: #007bff; }
    </style>
</head>
<body>
    <div class="certificate-container">

        <!-- Header -->
        <div class="header-row">
            <div class="logo-col">
                <img src="{% static 'assets/logo/image.png' %}" alt="Logo" style="height:80px; width:80px; object-fit:contain;">
            </div>
            <div class="text-col-full">
                <h5>“O‘zGASHKLITI” MCHJ Qurilishda muhandislik qidiruvlari,</h5>
                <h5>geoaxborot va shaharsozlik kadastri loyiha ilmiy-tadqiqot instituti</h5>
            </div>
            <div class="logo-col">
                <img src="{% static 'assets/logo/logo2.png' %}" alt="Logo" style="height:80px; width:80px; object-fit:contain;">
            </div>
            <div class="text-col-full">
                <h5>O‘ZBEKISTON RESPUBLIKASIDA O‘LCHASHLARNING </h5>
                <h5>YAGONA BIRLIKDA BO'LISHINI TA’MINLASH TIZIMI</h5>
            </div>
        </div>

        <!-- Title -->
        <div class="title-section">
            <h2>O‘lchash vositasini qiyoslash</h2>
            <h1>GUVOHNOMASI</h1>
            <p>№ {{ cert.certificate_number }}</p>
        </div>

        <!-- Details -->
        <div class="details-grid">
            {% if cert.standards_used %}
            <div class="details-row">
                <div class="label">Etalonlar (namunaviy o‘lchash vositalari) nomi va belgilanishi</div>
                <div class="colon">:</div>
                <div class="value">{{ cert.standards_used }}</div>
            </div>
            {% endif %}
            {% if cert.comparison_document %}
            <div class="details-row">
                <div class="label">Qiyoslash bo‘yicha hujjat nomi va belgilanishi</div>
                <div class="colon">:</div>
                <div class="value">{{ cert.comparison_document }}</div>
            </div>
            {% endif %}
            {% if cert.owner_name %}
            <div class="details-row">
                <div class="label">O‘lchash vositalarining egasi - yuridik shaxs</div>
                <div class="colon">:</div>
                <div class="value">INN: {{ cert.owner_inn }}<br> Nomi: {{ cert.owner_name }}</div>
            </div>
            {% endif %}
            {% if cert.manufacturer %}
            <div class="details-row">
                <div class="label">O‘lchash vositalarini tayyorlovchi</div>
                <div class="colon">:</div>
                <div class="value">{{ cert.manufacturer }}</div>
            </div>
            {% endif %}
            {% if cert.origin_country %}
            <div class="details-row">
                <div class="label">Tayyorlovchi – import qiluvchi mamlakat</div>
                <div class="colon">:</div>
                <div class="value">{{ cert.origin_country }}</div>
            </div>
            {% endif %}
            {% if cert.measurement_range %}
            <div class="details-row">
                <div class="label">O‘lchash vositalari parametrlari</div>
                <div class="colon">:</div>
                <div class="value">{{ cert.measurement_range }}</div>
            </div>
            {% endif %}
            {% if cert.error_limit %}
            <div class="details-row">
                <div class="label">Xatolik chegaralari / aniqlik klassi</div>
                <div class="colon">:</div>
                <div class="value">{{ cert.error_limit }}</div>
            </div>
            {% endif %}
            {% if cert.device_name %}
            <div class="details-row">
                <div class="label">O‘lchash vositasi</div>
                <div class="colon">:</div>
                <div class="value">{{ cert.device_name }}</div>
            </div>
            {% endif %}
            {% if cert.device_serial_numbers %}
            <div class="details-row">
                <div class="label">Zavod raqami</div>
                <div class="colon">:</div>
                <div class="value">{{ cert.device_serial_numbers }}</div>
            </div>
            {% endif %}
            {% if cert.comparison_methodology_doc %}
            <div class="details-row">
                <div class="label">Normativ hujjat</div>
                <div class="colon">:</div>
                <div class="value">{{ cert.comparison_methodology_doc }}</div>
            </div>
            {% endif %}
        </div>

        <!-- Footer Fixed -->
        <div class="footer-container">
            <div class="footer-info">
                Mazkur guvohnoma o‘lchash vositalari bo‘yicha etalonlarga muvofiqlikni tasdiqlaydi va o‘lchash birliklarini belgilangan standartlarga mos holda taqdim etadi.
            </div>

            <div class="signatures">
                <div class="sign-box">
                    {% if cert.qr_code_image %}
                        <img src="{{ cert.qr_code_image.url }}" alt="QR code" class="qr-code">
                    {% else %}
                        <div class="qr-code" style="border:1px dashed gray; display:flex; align-items:center; justify-content:center; font-size:10px;">QR CODE JOY</div>
                    {% endif %}
                    <p>Qiyoslash sanasi: <strong>{{ cert.comparison_date|date:"Y" }}-yil {{ cert.comparison_date|date:"d" }}-{{ cert.comparison_date|date:"F" }}</strong></p>
                    <p>Amal qilish muddati: <strong>{{ cert.valid_until_date|date:"Y" }}-yil {{ cert.valid_until_date|date:"d" }}-{{ cert.valid_until_date|date:"F" }} gacha</strong></p>
                </div>

                <div class="sign-box">
                    <p>Qiyoslovchi</p>
                    <p style="font-weight:bold;">{{ cert.metrologist_name }}</p>
                    <p style="border-top:1px solid black; width:100px; margin:5px auto 0;"></p>
                </div>

                <div class="sign-box">
                    <p>Tasdiqlovchi</p>
                    <p style="font-weight:bold;">
                        {% if cert.approved_by %}{{ cert.approved_by.user.get_full_name }}{% else %}_______________{% endif %}
                    </p>
                    <p style="border-top:1px solid black; width:100px; margin:5px auto 0;"></p>
                </div>
            </div>

            <div class="bottom-warning">
                Mazkur guvohnomani qalbakilashtirish - qonunga muvofiq javobgarlikka tortiladi.
            </div>
        </div>

    </div>
</body>
</html>
